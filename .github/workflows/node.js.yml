# This workflow will do a clean install of node dependencies, build the source code and run tests across different versions of node
# For more information see: https://help.github.com/actions/language-and-framework-guides/using-nodejs-with-github-actions

name: Node.js CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build-and-publish:
    name: build and public
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: npm install
      uses: actions/npm@master
      with:
          args: install
          
#     - name: npm test
#       uses: actions/npm@master
#       with:
#           args: run test
    - name: npm lint
      uses: actions/npm@master
    - name: docker build
      uses: actions/docker/cli@master
      with:
        args: build -t hoang1712/nodejs-docker-cnpm .
    - name: docker login
      uses: actions/docker/login@master
      env:
        DOCKER_PASSWORD: ${{ secrets.DOCKER_PASSWORD }}
        DOCKER_USERNAME: ${{ secrets.DOCKER_USERNAME }}
    - name: docker push
      uses: actions/docker/cli@master
      with:
        args: push hoang1712/nodejs-docker-cnpm
